<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√¨nh Theo D√µi T·∫≠p Gym</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4a90e2"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
</head>
<body>
    <main>
        <div id="auth-container" class="container">
            <div class="auth-header">
                <h1>üèãÔ∏è Gym Workout Tracker</h1>
            </div>
            <h2>Ch√†o m·ª´ng b·∫°n!</h2>
            <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ ƒë·ªìng b·ªô d·ªØ li·ªáu t·∫≠p luy·ªán c·ªßa b·∫°n tr√™n m·ªçi thi·∫øt b·ªã.</p>
            <div class="auth-buttons">
                <button id="login-google-btn">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google logo">
                    <span>ƒêƒÉng nh·∫≠p v·ªõi Google</span>
                </button>
                <button id="login-email-btn">ƒêƒÉng nh·∫≠p v·ªõi Email</button>
            </div>
        </div>

        <div id="app-content" class="hidden">
            <header>
                <h1>üèãÔ∏è Theo D√µi T·∫≠p Gym</h1>
                <div class="header-controls">
                    <div id="user-info" class="hidden">
                        <span id="user-display-name"></span>
                        <button id="logout-btn" class="secondary">ƒêƒÉng xu·∫•t</button>
                    </div>
                    <div class="theme-switcher-container">
                        <label for="theme-toggle" class="theme-switcher">
                            <input type="checkbox" id="theme-toggle" />
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </header>
            <div class="container workout-form">
                <h1>üìù Tr√¨nh theo d√µi t·∫≠p Gym</h1>
        
                <form id="workout-form">
                    <div class="form-group">
                        <label for="workout-date">Ng√†y t·∫≠p</label>
                        <input type="date" id="workout-date" required>
                    </div>

                    <div class="form-group">
                        <label for="muscle-group">Nh√≥m c∆°</label>
                        <select id="muscle-group" required>
                            <option value="">-- Ch·ªçn nh√≥m c∆° --</option>
                            <option value="Ng·ª±c">Ng·ª±c (Chest)</option>
                            <option value="L∆∞ng">L∆∞ng (Back)</option>
                            <option value="Ch√¢n">Ch√¢n (Legs)</option>
                            <option value="Tay">Tay (Arms)</option>
                            <option value="B·ª•ng">B·ª•ng (Abs)</option>
                            <option value="Vai">Vai (Shoulders)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="exercise-name">T√™n b√†i t·∫≠p</label>
                        <input type="text" id="exercise-name" placeholder="VD: Bench Press, Pull-up, Push-up..." required>
                    </div>

                    <div class="form-group">
                        <label for="exercise-type">Lo·∫°i b√†i t·∫≠p</label>
                        <select id="exercise-type" required>
                            <option value="">-- Ch·ªçn lo·∫°i b√†i t·∫≠p --</option>
                            <option value="weight">C√≥ t·∫° (Weight Training)</option>
                            <option value="bodyweight">Kh√¥ng t·∫° (Bodyweight)</option>
                        </select>
                    </div>

                    <div class="form-group" id="equipment-group">
                        <label for="equipment">M√°y t·∫≠p / D·ª•ng c·ª•</label>
                        <input type="text" id="equipment" placeholder="VD: T·∫° ƒë√≤n, X√† ƒë∆°n, S√†n...">
                    </div>

                    <div class="sets-section">
                        <div class="sets-header">
                            <h3>Chi ti·∫øt c√°c Set</h3>
                            <button type="button" id="add-set" class="btn btn-secondary">+ Th√™m Set</button>
                        </div>
                        <div id="sets-container">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="notes">Ghi ch√∫ th√™m</label>
                        <textarea id="notes" placeholder="C·∫£m nh·∫≠n, k·ªπ thu·∫≠t..."></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary">L∆∞u b√†i t·∫≠p</button>
                </form>

                <div class="chart-section">
                    <h2>üìà Bi·ªÉu ƒë·ªì so s√°nh b√†i t·∫≠p</h2>
                    <div class="chart-controls">
                        <select id="chart-exercise">
                            <option value="">Ch·ªçn b√†i t·∫≠p</option>
                        </select>
                        <select id="chart-metric">
                            <option value="weight">M·ª©c t·∫° (kg)</option>
                            <option value="reps">S·ªë l·∫ßn l·∫∑p (reps)</option>
                            <option value="volume">T·ªïng kh·ªëi l∆∞·ª£ng (kg √ó reps)</option>
                        </select>
                        <select id="chart-period">
                            <option value="7">7 ng√†y g·∫ßn nh·∫•t</option>
                            <option value="30">30 ng√†y g·∫ßn nh·∫•t</option>
                            <option value="90">90 ng√†y g·∫ßn nh·∫•t</option>
                            <option value="all">T·∫•t c·∫£</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="progress-chart"></canvas>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>üìä Th·ªëng k√™ t·ªïng quan</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>T·ªïng s·ªë bu·ªïi t·∫≠p</h3>
                            <div id="total-workouts" class="stat-value">0</div>
                        </div>
                        <div class="stat-card">
                            <h3>B√†i t·∫≠p ƒë∆∞·ª£c t·∫≠p nhi·ªÅu nh·∫•t</h3>
                            <div id="most-exercised" class="stat-value">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Nh√≥m c∆° t·∫≠p nhi·ªÅu nh·∫•t</h3>
                            <div id="most-muscle-group" class="stat-value">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>T·ªïng kh·ªëi l∆∞·ª£ng</h3>
                            <div id="total-volume" class="stat-value">0 kg</div>
                        </div>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>üí™ ∆Ø·ªõc t√≠nh 1RM (One-Rep Max)</h2>
                    <div class="chart-controls">
                        <select id="rm-exercise">
                            <option value="">Ch·ªçn b√†i t·∫≠p</option>
                        </select>
                    </div>
                    <div id="rm-overview">
                        <p style="text-align: center; color: #666; font-style: italic;">Ch·ªçn m·ªôt b√†i t·∫≠p ƒë·ªÉ xem ∆∞·ªõc t√≠nh 1RM</p>
                    </div>
                </div>

                <div class="history-section">
                    <div class="history-controls">
                         <h2>L·ªãch s·ª≠ t·∫≠p luy·ªán</h2>
                        <div class="data-controls">
                            <button id="export-data" class="btn btn-success">üì§ Xu·∫•t d·ªØ li·ªáu</button>
                            <input type="file" id="import-file" accept=".json" style="display: none;">
                            <button id="import-data" class="btn btn-secondary">üì• Nh·∫≠p d·ªØ li·ªáu</button>
                            <button id="delete-all" class="btn btn-danger">üóëÔ∏è X√≥a t·∫•t c·∫£</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="history-table">
                            <thead>
                                <tr>
                                    <th>Ng√†y</th>
                                    <th>Nh√≥m c∆°</th>
                                    <th>B√†i t·∫≠p</th>
                                    <th>D·ª•ng c·ª•</th>
                                    <th>Chi ti·∫øt Sets</th>
                                    <th>T·ªïng kh·ªëi l∆∞·ª£ng</th>
                                    <th>Ghi ch√∫</th>
                                    <th>Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody id="history-body">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Edit Modal -->
            <div id="edit-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>‚úèÔ∏è Ch·ªânh s·ª≠a b√†i t·∫≠p</h2>
                        <span class="close">&times;</span>
                    </div>
                    <form id="edit-form">
                        <input type="hidden" id="edit-id">
                        <div class="form-group">
                            <label for="edit-workout-date">Ng√†y t·∫≠p</label>
                            <input type="date" id="edit-workout-date" required>
                        </div>

                        <div class="form-group">
                            <label for="edit-muscle-group">Nh√≥m c∆°</label>
                            <select id="edit-muscle-group" required>
                                <option value="">-- Ch·ªçn nh√≥m c∆° --</option>
                                <option value="Ng·ª±c">Ng·ª±c (Chest)</option>
                                <option value="L∆∞ng">L∆∞ng (Back)</option>
                                <option value="Ch√¢n">Ch√¢n (Legs)</option>
                                <option value="Tay">Tay (Arms)</option>
                                <option value="B·ª•ng">B·ª•ng (Abs)</option>
                                <option value="Vai">Vai (Shoulders)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="edit-exercise-name">T√™n b√†i t·∫≠p</label>
                            <input type="text" id="edit-exercise-name" placeholder="VD: Bench Press, Pull-up, Push-up..." required>
                        </div>

                        <div class="form-group">
                            <label for="edit-exercise-type">Lo·∫°i b√†i t·∫≠p</label>
                            <select id="edit-exercise-type" required>
                                <option value="">-- Ch·ªçn lo·∫°i b√†i t·∫≠p --</option>
                                <option value="weight">C√≥ t·∫° (Weight Training)</option>
                                <option value="bodyweight">Kh√¥ng t·∫° (Bodyweight)</option>
                            </select>
                        </div>

                        <div class="form-group" id="edit-equipment-group">
                            <label for="edit-equipment">M√°y t·∫≠p / D·ª•ng c·ª•</label>
                            <input type="text" id="edit-equipment" placeholder="VD: T·∫° ƒë√≤n, X√† ƒë∆°n, S√†n...">
                        </div>

                        <div class="sets-section">
                            <div class="sets-header">
                                <h3>Chi ti·∫øt c√°c Set</h3>
                                <button type="button" id="edit-add-set" class="btn btn-secondary">+ Th√™m Set</button>
                            </div>
                            <div id="edit-sets-container">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="edit-notes">Ghi ch√∫ th√™m</label>
                            <textarea id="edit-notes" placeholder="C·∫£m nh·∫≠n, k·ªπ thu·∫≠t..."></textarea>
                        </div>

                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="submit" class="btn btn-success">L∆∞u thay ƒë·ªïi</button>
                            <button type="button" id="cancel-edit" class="btn btn-secondary">H·ªßy b·ªè</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- Auth Modal for Email/Password -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="close-auth-modal">&times;</span>
            <h2 id="auth-modal-title">ƒêƒÉng nh·∫≠p</h2>
            <form id="auth-form">
                <input type="email" id="auth-email" placeholder="Email" required>
                <input type="password" id="auth-password" placeholder="M·∫≠t kh·∫©u (t·ªëi thi·ªÉu 6 k√Ω t·ª±)" required>
                <p id="auth-error" class="error-text"></p>
                <div id="auth-actions">
                    <button type="submit" id="auth-submit-btn">ƒêƒÉng nh·∫≠p</button>
                    <a href="#" id="auth-toggle-link">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω</a>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script src="app.js?v=3" defer></script>
</body>
</html>